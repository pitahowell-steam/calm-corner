<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kawaii Calm</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/react-native-web@0.19.6/dist/bundle.js"></script>

  <style>
    html, body, #app-root { height: 100%; width: 100%; overflow: hidden; margin: 0; padding: 0; background-color: #FDFCF0; font-family: sans-serif; }
    .fallback { display: flex; justify-content: center; align-items: center; height: 100vh; text-align: center; padding: 20px; color: #666; }
  </style>
</head>
<body>
  <div id="app-root">
    <div class="fallback">
      <div>
        <h2>âœ¨ Initializing Sanctuary...</h2>
        <p>If this screen stays blank for more than 10 seconds, please refresh.</p>
      </div>
    </div>
  </div>

  <script>
    // This version uses standard JS instead of Babel to prevent blank screens
    const { useState, useRef, useEffect, useCallback } = React;
    const { Text, View, StyleSheet, TouchableOpacity, Animated, SafeAreaView, ScrollView, TextInput, Dimensions } = ReactNative;

    const { width, height } = Dimensions.get('window');

    function App() {
      const [screen, setScreen] = useState('login');
      const [user, setUser] = useState('');
      const [breathText, setBreathText] = useState('Get Ready...');
      const breathAnim = useRef(new Animated.Value(0.2)).current;

      const runBreath = (cycle, step) => {
        const steps = ["Breathe In...", "Hold...", "Breathe Out...", "Rest..."];
        const pattern = [{v:1, d:4000}, {v:1, d:2000}, {v:0.2, d:6000}, {v:0.2, d:2000}];
        setBreathText(steps[step]);
        
        Animated.timing(breathAnim, {
          toValue: pattern[step].v,
          duration: pattern[step].d,
          useNativeDriver: false
        }).start(() => {
          if (step < 3) runBreath(cycle, step + 1);
          else if (cycle < 1) runBreath(cycle + 1, 0);
          else setScreen('home');
        });
      };

      // Simple internal components for stability
      const Login = () => React.createElement(View, { style: styles.center },
        React.createElement(Text, { style: styles.title }, "Kawaii Calm"),
        React.createElement(TextInput, { 
          style: styles.input, 
          placeholder: "Student Name",
          onChangeText: (val) => setUser(val)
        }),
        React.createElement(TouchableOpacity, { 
          style: styles.btn, 
          onPress: () => setScreen('home') 
        }, React.createElement(Text, { style: styles.btnText }, "Enter Sanctuary"))
      );

      const Home = () => React.createElement(View, { style: styles.center },
        React.createElement(Text, { style: styles.title }, "Hello, " + user + " âœ¨"),
        React.createElement(TouchableOpacity, { 
          style: styles.card, 
          onPress: () => { setScreen('breathing'); runBreath(0,0); } 
        }, React.createElement(Text, { style: {fontSize: 18, fontWeight: 'bold'} }, "ðŸŒ¸ Start Calm Session"))
      );

      const Breathing = () => React.createElement(View, { style: [styles.center, {backgroundColor: '#111'}] },
        React.createElement(Text, { style: {color: 'white', fontSize: 24, marginBottom: 50} }, breathText),
        React.createElement(Animated.View, { 
          style: [styles.circle, { transform: [{ scale: breathAnim }] }] 
        })
      );

      return React.createElement(View, { style: {flex: 1} },
        screen === 'login' ? Login() : (screen === 'home' ? Home() : Breathing())
      );
    }

    const styles = StyleSheet.create({
      center: { flex: 1, justifyContent: 'center', alignItems: 'center', padding: 20 },
      title: { fontSize: 32, fontWeight: 'bold', marginBottom: 20, color: '#444' },
      input: { width: 280, padding: 15, backgroundColor: 'white', borderRadius: 10, border: '1px solid #DDD', marginBottom: 20 },
      btn: { backgroundColor: '#B2CEFE', paddingVertical: 15, paddingHorizontal: 40, borderRadius: 30 },
      btnText: { color: 'white', fontWeight: 'bold' },
      card: { width: 280, padding: 30, backgroundColor: 'white', borderRadius: 20, border: '2px solid #FFB7B2', alignItems: 'center' },
      circle: { width: 200, height: 200, borderRadius: 100, backgroundColor: '#B2CEFE' }
    });

    const root = ReactDOM.createRoot(document.getElementById('app-root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>
